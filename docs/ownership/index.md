# 所有权

Rust的核心功能（之一）是**所有权（ownership）**。

所有运行的程序都必须管理其使用计算机内存的方式。一些语言中具有垃圾回收机制，在程序运行时不断地寻找不再使用的内存；在另一些语言中，程序员必须亲自分配和释放内存。Rust 则选择了第三种方式：通过所有权系统管理内存，编译器在编译时会根据一系列的规则进行检查。在运行时，所有权系统的任何功能都不会减慢程序。

## 栈（Stack）与堆（Heap）

值是位于栈上还是堆上在更大程度上影响了语言的行为以及为何必须做出这样的抉择。

栈和堆都是代码在运行时可供使用的内存，但是它们的结构不同。

#### 栈

- 栈以放入值的顺序存储值并以相反顺序取出值。这也被称作 后进先出（last in, first out）。
- 增加数据叫做 进栈（pushing onto the stack），而移出数据叫做 出栈（popping off the stack）。
- 栈中的所有数据都必须占用已知且固定的大小。
- 入栈比在堆上分配内存要快，因为（入栈时）操作系统无需为存储新数据去搜索内存空间；其位置总是在栈顶。
- 当你的代码调用一个函数时，传递给函数的值（包括可能指向堆上数据的指针）和函数的局部变量被压入栈中。当函数结束时，这些值被移出栈。


#### 堆

- 在编译时大小未知或大小可能变化的数据，要改为存储在堆上。
- 堆是缺乏组织的：当向堆放入数据时，你要请求一定大小的空间。
- 操作系统在堆的某处找到一块足够大的空位，把它标记为已使用，并返回一个表示该位置地址的**指针（pointer）**。这个过程称作**在堆上分配内存（allocating on the heap）**，有时简称为 **“分配”（allocating）**。
- 访问堆上的数据比访问栈上的数据慢，因为必须通过指针来访问。


### 所有权规则

1. Rust中的每一个值都有一个被称为其 **所有者（owner）** 的变量。
2. 值在任一时刻有且只有一个所有者。
3. 当所有者离开作用域，这个值将被丢弃。

### String类型

String类型被分配到堆上。

